<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Protocol 724 | The Journey</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700&family=Cinzel:wght@400;700&family=Playfair+Display:ital,wght@1,400;1,700&display=swap" rel="stylesheet">

    <style>
        /* --- CORE --- */
        :root { --gold: #D4AF37; --blue: #0ff; --black: #050505; }
        body { background-color: var(--black); color: white; font-family: 'Inter', sans-serif; overflow-x: hidden; touch-action: pan-y; -webkit-tap-highlight-color: transparent; }
        
        /* --- HUD SCANNER (Restored) --- */
        .hud-container { position: fixed; inset: 0; z-index: 9999; background: radial-gradient(circle, #001a2c 0%, #000 90%); display: flex; align-items: center; justify-content: center; font-family: 'Share Tech Mono'; color: var(--blue); }
        .scan-frame { width: 300px; height: 300px; border: 2px solid rgba(0,255,255,0.2); position: relative; }
        .bracket { position: absolute; width: 30px; height: 30px; border: 4px solid var(--blue); transition: 0.5s; }
        .tl { top: -2px; left: -2px; border-bottom: 0; border-right: 0; }
        .tr { top: -2px; right: -2px; border-bottom: 0; border-left: 0; }
        .bl { bottom: -2px; left: -2px; border-top: 0; border-right: 0; }
        .br { bottom: -2px; right: -2px; border-top: 0; border-left: 0; }
        .scan-line { width: 100%; height: 2px; background: var(--blue); box-shadow: 0 0 10px var(--blue); position: absolute; top: 0; opacity: 0; }
        
        /* --- UI ELEMENTS --- */
        .key-counter { position: fixed; top: 20px; right: 20px; z-index: 50; background: rgba(0,0,0,0.5); backdrop-filter: blur(10px); padding: 10px 20px; border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); display: none; }
        .hidden-key { position: absolute; font-size: 2rem; color: var(--gold); cursor: pointer; animation: float 3s infinite ease-in-out; z-index: 40; filter: drop-shadow(0 0 10px var(--gold)); opacity: 0.7; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* --- TIME TRAVEL SLIDER --- */
        .slider-container { position: relative; width: 100%; max-width: 600px; height: 400px; margin: 0 auto; overflow: hidden; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); }
        .img-before, .img-after { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        .img-after { clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%); }
        .slider-handle { position: absolute; top: 0; bottom: 0; left: 50%; width: 4px; background: white; cursor: ew-resize; z-index: 10; }
        .handle-knob { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; background: white; border-radius: 50%; display: flex; items-center; justify-content: center; color: black; box-shadow: 0 0 20px rgba(0,0,0,0.5); }

        /* --- GLOBE --- */
        #globe-canvas { width: 100%; height: 500px; }

        /* --- THE VAULT & SCRATCH CARD --- */
        #vault-overlay { position: fixed; inset: 0; background: #000; z-index: 9000; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; }
        .vault-door { width: 100px; height: 100px; border: 2px solid var(--gold); border-radius: 50%; display: flex; items-center; justify-content: center; font-size: 2rem; color: var(--gold); }
        
        #scratch-section { position: fixed; inset: 0; background: #000; z-index: 9001; display: none; flex-direction: column; align-items: center; justify-content: center; }
        canvas#scratch-card { border-radius: 10px; cursor: crosshair; touch-action: none; }
        .gift-underlay { position: absolute; text-align: center; pointer-events: none; width: 300px; }
        
        /* --- UTILS --- */
        .font-cinematic { font-family: 'Cinzel', serif; }
        .text-gradient { background: linear-gradient(to right, #bf953f, #fcf6ba, #aa771c); -webkit-background-clip: text; color: transparent; }
    </style>
</head>
<body>

    <audio id="sfx-scan" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio> 
    <audio id="sfx-success" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>
    <audio id="bg-music" loop><source src="https://cdn.pixabay.com/audio/2022/05/27/audio_1808fbf07a.mp3" type="audio/mp3"></audio>

    <div class="key-counter" id="key-counter">
        <i class="fas fa-key text-yellow-400 mr-2"></i> <span id="keys-found">0</span>/3
    </div>

    <div id="hud-layer" class="hud-container">
        <div class="flex flex-col items-center gap-6 text-center px-4">
            <div class="scan-frame" id="scanner">
                <div class="bracket tl"></div><div class="bracket tr"></div><div class="bracket bl"></div><div class="bracket br"></div>
                <div class="scan-line"></div>
                <div class="absolute inset-0 flex items-center justify-center opacity-30"><i class="fas fa-fingerprint text-9xl"></i></div>
            </div>
            <div>
                <h2 id="status" class="text-xl md:text-2xl font-bold tracking-widest text-[#0ff]">SYSTEM LOCKED</h2>
                <p id="sub-status" class="text-xs md:text-sm opacity-70 mt-2">BIOMETRIC REQUIRED</p>
            </div>
            <button id="start-btn" class="mt-8 px-8 py-3 border border-[#0ff] text-[#0ff] tracking-[0.3em] uppercase text-sm animate-pulse hover:bg-[#0ff] hover:text-black transition-all">
                Initiate Scan
            </button>
        </div>
    </div>

    <div id="main-content" class="opacity-0 transition-opacity duration-1000">
        
        <section class="relative h-screen bg-black overflow-hidden flex flex-col items-center justify-center">
            <canvas id="star-canvas" class="absolute inset-0"></canvas>
            <div class="relative z-10 text-center px-4 mt-20">
                <p class="text-xs tracking-[0.5em] text-gray-500 mb-4">TEMPORAL COORDINATES</p>
                <h1 class="text-6xl md:text-8xl font-cinematic text-white mb-2">OCT 24</h1> <p class="text-yellow-500 italic font-serif">"The stars aligned for you."</p>
            </div>
            
            <div class="hidden-key" style="top: 80%; left: 10%;" onclick="collectKey(this)">ðŸ”‘</div>
        </section>

        <section class="py-20 bg-[#0a0a0a] px-4">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-cinematic text-white">Time Travel</h2>
                <p class="text-gray-500 text-sm">Drag to see the journey</p>
            </div>
            
            <div class="slider-container" id="slider-box">
                <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=600" class="img-before" alt="Now">
                <img src="https://images.unsplash.com/photo-1519689680058-324335c77eba?w=600" class="img-after" id="img-after" alt="Baby">
                
                <div class="slider-handle" id="slider-handle">
                    <div class="handle-knob"><i class="fas fa-arrows-alt-h"></i></div>
                </div>
            </div>
        </section>

        <section class="py-20 bg-black relative overflow-hidden">
            <div class="text-center px-4 mb-8">
                <h2 class="text-3xl font-cinematic text-white">Global Wishes</h2>
                <p class="text-gray-500">Love from every corner</p>
            </div>
            
            <div class="relative h-[400px] flex items-center justify-center">
                <canvas id="globe-canvas"></canvas>
                <div class="absolute w-16 h-16 rounded-full bg-cover border-2 border-white/50 animate-bounce" style="background-image:url('https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=100'); top: 20%; left: 20%;"></div>
                <div class="absolute w-20 h-20 rounded-full bg-cover border-2 border-white/50 animate-bounce" style="background-image:url('https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=100'); top: 60%; right: 20%; animation-delay: 1s;"></div>
            </div>

            <div class="hidden-key" style="bottom: 10%; right: 10%;" onclick="collectKey(this)">ðŸ”‘</div>
        </section>

        <section class="py-24 bg-gradient-to-b from-[#050505] to-[#111]">
            <div class="px-6 mb-12">
                <h2 class="text-3xl font-cinematic text-white">Memories</h2>
                <div class="h-1 w-20 bg-yellow-600 mt-2"></div>
            </div>
            
            <div class="space-y-12 px-4">
                <div class="relative h-64 md:h-96 rounded-2xl overflow-hidden parallax-wrap">
                    <img src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=800" class="w-full h-[120%] object-cover parallax-img">
                </div>
                <div class="relative h-64 md:h-96 rounded-2xl overflow-hidden parallax-wrap">
                    <img src="https://images.unsplash.com/photo-1517841905240-472988babdf9?w=800" class="w-full h-[120%] object-cover parallax-img">
                    <div class="hidden-key" style="top: 50%; left: 50%;" onclick="collectKey(this)">ðŸ”‘</div>
                </div>
            </div>
        </section>
        
        <div class="h-40 bg-black flex items-center justify-center text-gray-700 text-sm">
            Collect all 3 keys to open the vault...
        </div>
    </div>

    <div id="vault-overlay">
        <div class="text-center">
            <div class="vault-door mb-6"><i class="fas fa-lock"></i></div>
            <h2 class="text-2xl text-white font-cinematic">VAULT UNLOCKED</h2>
            <p class="text-gray-400 mt-2 animate-pulse">Entering Secure Chamber...</p>
        </div>
    </div>

    <div id="scratch-section">
        <div class="relative">
            <div class="gift-underlay">
                <h3 class="text-gold text-xl font-bold mb-2">HAPPY BIRTHDAY!</h3>
                <h2 class="text-3xl text-white font-bold mb-4">WE ARE GOING TO PARIS!</h2>
                <p class="text-gray-400 text-sm">Pack your bags for next weekend.</p>
            </div>
            <canvas id="scratch-card" width="300" height="150"></canvas>
        </div>
        <p class="text-gray-500 mt-8 text-sm animate-pulse">Scratch to reveal your gift</p>
    </div>

    <script>
        // --- CONFIGURATION ---
        const HER_NAME = "SARAH"; 

        // --- 1. HUD LOGIC ---
        const startBtn = document.getElementById('start-btn');
        const hudLayer = document.getElementById('hud-layer');
        const mainContent = document.getElementById('main-content');
        const sfxScan = document.getElementById('sfx-scan');
        const sfxSuccess = document.getElementById('sfx-success');
        const bgMusic = document.getElementById('bg-music');
        const keyCounter = document.getElementById('key-counter');

        startBtn.addEventListener('click', () => {
            startBtn.style.display = 'none';
            sfxScan.volume = 0.5; sfxScan.play();
            
            // Animation
            const tl = gsap.timeline();
            tl.to('.scan-line', { opacity: 1, duration: 0.2 })
              .to('.scan-line', { top: '100%', duration: 2, ease: "power2.inOut", repeat: 1, yoyo: true });

            setTimeout(() => {
                sfxScan.pause(); sfxSuccess.play();
                document.getElementById('status').innerText = "ACCESS GRANTED";
                document.getElementById('status').style.color = "#0f0";
                document.querySelector('.scan-frame').style.borderColor = "#0f0";
                
                setTimeout(() => {
                    gsap.to(hudLayer, { y: '-100%', duration: 1, ease: "power2.in" });
                    mainContent.style.opacity = 1;
                    keyCounter.style.display = "block";
                    bgMusic.volume = 0.4; bgMusic.play();
                    initStarMap();
                    initGlobe();
                }, 1500);
            }, 3500);
        });

        // --- 2. TIME TRAVEL SLIDER ---
        const sliderBox = document.getElementById('slider-box');
        const imgAfter = document.getElementById('img-after');
        const handle = document.getElementById('slider-handle');

        function moveSlider(e) {
            const rect = sliderBox.getBoundingClientRect();
            let x = (e.clientX || e.touches[0].clientX) - rect.left;
            x = Math.max(0, Math.min(x, rect.width));
            const percent = (x / rect.width) * 100;
            
            imgAfter.style.clipPath = `polygon(0 0, ${percent}% 0, ${percent}% 100%, 0 100%)`;
            handle.style.left = `${percent}%`;
        }

        sliderBox.addEventListener('mousemove', moveSlider);
        sliderBox.addEventListener('touchmove', moveSlider);

        // --- 3. STAR MAP (Lightweight) ---
        function initStarMap() {
            const canvas = document.getElementById('star-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            
            const stars = Array(200).fill().map(() => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 2,
                speed: Math.random() * 0.5
            }));

            function animate() {
                ctx.fillStyle = 'black'; ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = 'white';
                stars.forEach(s => {
                    s.y -= s.speed;
                    if(s.y < 0) s.y = canvas.height;
                    ctx.beginPath(); ctx.arc(s.x, s.y, s.size, 0, Math.PI*2); ctx.fill();
                });
                requestAnimationFrame(animate);
            }
            animate();
        }

        // --- 4. HOLOGRAPHIC GLOBE ---
        function initGlobe() {
            const canvas = document.getElementById('globe-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = 400;
            let time = 0;

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const cx = canvas.width / 2; const cy = canvas.height / 2;
                
                ctx.fillStyle = '#0ff';
                for(let i=0; i<150; i++) {
                    const lat = Math.acos(1 - 2 * (i + 0.5) / 150);
                    const lon = Math.PI * 10 * (i + 0.5) / 150 + time;
                    
                    const r = 120;
                    const x = cx + r * Math.sin(lat) * Math.cos(lon);
                    const z = r * Math.sin(lat) * Math.sin(lon); // Depth
                    const y = cy + r * Math.cos(lat);
                    
                    if(z > 0) { // Only draw front
                        const size = (z/r) * 2 + 1;
                        ctx.beginPath(); ctx.arc(x, y, size, 0, Math.PI*2); ctx.fill();
                    }
                }
                time += 0.01;
                requestAnimationFrame(draw);
            }
            draw();
        }

        // --- 5. SCAVENGER HUNT & VAULT ---
        let keysFound = 0;
        function collectKey(el) {
            if(el.style.display === 'none') return;
            
            // Animation
            gsap.to(el, { scale: 2, opacity: 0, duration: 0.5 });
            el.style.pointerEvents = 'none';
            
            keysFound++;
            document.getElementById('keys-found').innerText = keysFound;
            
            // Confetti for key find
            confetti({ particleCount: 50, spread: 50, origin: { x: el.getBoundingClientRect().left/window.innerWidth, y: el.getBoundingClientRect().top/window.innerHeight } });

            if(keysFound === 3) {
                setTimeout(openVault, 1000);
            }
        }

        function openVault() {
            const vault = document.getElementById('vault-overlay');
            vault.style.pointerEvents = 'all';
            gsap.to(vault, { opacity: 1, duration: 1 });
            
            setTimeout(() => {
                // Unlock Animation
                const door = vault.querySelector('.vault-door');
                door.innerHTML = '<i class="fas fa-lock-open"></i>';
                gsap.to(door, { scale: 50, opacity: 0, duration: 1.5, ease: "power2.in" });
                
                setTimeout(() => {
                    vault.style.display = 'none';
                    initScratchCard();
                }, 1000);
            }, 2000);
        }

        // --- 6. SCRATCH CARD (ENDING) ---
        function initScratchCard() {
            const section = document.getElementById('scratch-section');
            section.style.display = 'flex';
            
            const canvas = document.getElementById('scratch-card');
            const ctx = canvas.getContext('2d');
            
            // Fill Silver
            ctx.fillStyle = '#C0C0C0';
            ctx.fillRect(0, 0, 300, 150);
            
            // Add Text Overlay
            ctx.fillStyle = '#000';
            ctx.font = "20px Arial";
            ctx.fillText("SCRATCH HERE", 75, 80);

            let isDrawing = false;

            function scratch(e) {
                if (!isDrawing) return;
                e.preventDefault(); // Stop scrolling on mobile
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                
                ctx.globalCompositeOperation = 'destination-out';
                ctx.beginPath();
                ctx.arc(x, y, 20, 0, Math.PI * 2);
                ctx.fill();
                
                checkScratchPercent();
            }

            canvas.addEventListener('mousedown', () => isDrawing = true);
            canvas.addEventListener('touchstart', () => isDrawing = true);
            window.addEventListener('mouseup', () => isDrawing = false);
            window.addEventListener('touchend', () => isDrawing = false);
            canvas.addEventListener('mousemove', scratch);
            canvas.addEventListener('touchmove', scratch);
        }

        function checkScratchPercent() {
            // Optional: If scratched > 50%, reveal all (simplified here)
            // Just let them scratch manually for satisfaction
        }

        // --- 7. SCROLL ANIMATIONS ---
        gsap.utils.toArray('.parallax-wrap').forEach(container => {
            let img = container.querySelector('img');
            gsap.to(img, {
                y: "20%",
                ease: "none",
                scrollTrigger: {
                    trigger: container,
                    start: "top bottom",
                    end: "bottom top",
                    scrub: true
                }
            });
        });

    </script>
</body>
</html>
