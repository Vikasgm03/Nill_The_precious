<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clear the Path</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: url('https://images.unsplash.com/photo-1518020382113-a7e8fc38eac9?q=80&w=2000') no-repeat center center fixed; background-size: cover; }
        canvas { position: absolute; top: 0; left: 0; cursor: crosshair; touch-action: none; }
        
        .hidden-content {
            position: absolute; inset: 0; display: flex; flex-col; align-items: center; justify-content: center;
            z-index: 0; pointer-events: none; /* Initially allow clicks to pass through to canvas? No, canvas is on top */
        }
        
        .enter-btn {
            padding: 15px 40px; background: white; color: black; font-family: sans-serif;
            text-transform: uppercase; letter-spacing: 4px; border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); cursor: pointer; pointer-events: auto;
            opacity: 0; transition: opacity 0.5s; font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="hidden-content">
        <h1 class="text-white text-4xl mb-8 font-bold drop-shadow-md">It's Time</h1>
        <button class="enter-btn" id="enterBtn" onclick="goToHome()">Enter Party</button>
    </div>

    <canvas id="fog"></canvas>
    
    <div class="absolute bottom-10 w-full text-center pointer-events-none">
        <p class="text-white/70 tracking-widest text-sm uppercase drop-shadow-md">Wipe the screen to reveal</p>
    </div>

    <script>
        const canvas = document.getElementById('fog');
        const ctx = canvas.getContext('2d');
        const btn = document.getElementById('enterBtn');
        let width, height;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            resetFog();
        }

        function resetFog() {
            ctx.fillStyle = "rgba(200, 200, 200, 0.95)"; // The fog color
            ctx.fillRect(0, 0, width, height);
            ctx.font = "20px Arial";
            ctx.fillStyle = "rgba(0,0,0,0.1)";
        }

        function scratch(x, y) {
            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath();
            ctx.arc(x, y, 50, 0, Math.PI * 2); // Brush size
            ctx.fill();
            checkReveal();
        }

        // Check how much is cleared
        let revealed = false;
        function checkReveal() {
            if(revealed) return;
            // Simple logic: After some interaction, show button
            // In a real app we'd count pixels, but let's just use a timer or rough estimate
        }
        
        // Show button after 1 second of interaction for better UX
        let interactionStarted = false;
        function startInteraction() {
            if(!interactionStarted) {
                interactionStarted = true;
                setTimeout(() => {
                    btn.style.opacity = 1;
                    revealed = true;
                    // Fade out canvas slowly
                    canvas.style.transition = "opacity 2s";
                    canvas.style.opacity = 0;
                    setTimeout(() => canvas.style.display = 'none', 2000);
                }, 1000);
            }
        }

        window.addEventListener('resize', resize);
        resize();

        // Mouse Events
        let isDrawing = false;
        canvas.addEventListener('mousedown', () => isDrawing = true);
        window.addEventListener('mouseup', () => isDrawing = false);
        canvas.addEventListener('mousemove', (e) => {
            if(isDrawing) {
                scratch(e.clientX, e.clientY);
                startInteraction();
            }
        });

        // Touch Events
        canvas.addEventListener('touchstart', (e) => { isDrawing = true; scratch(e.touches[0].clientX, e.touches[0].clientY); startInteraction(); });
        canvas.addEventListener('touchmove', (e) => {
            if(isDrawing) {
                scratch(e.touches[0].clientX, e.touches[0].clientY);
                e.preventDefault();
            }
        });

        function goToHome() {
            window.location.href = 'home.html';
        }
    </script>
</body>
</html>
